{% trans_default_domain "payment" %}

{% import "DzangocartCoreBundle:Payment:status.html.twig" as status %}

{% spaceless %}
{
    "draw": "{{ draw }}",
    "recordsTotal": {{ count_total }},
    "recordsFiltered": {{ count_filtered }},
    "data" : [
        {% for payment in payments %}
            {
                "DT_RowId":     "{{ 'payment_' ~ payment.id }}",
                "DT_RowClass":  "{{ 'payment' }}",
                "check":        "",
                "date":         "{{ payment.createdAt|datetime('dd.MM.yy', 'HH:mm', time_zone, app.request.locale) }}",
                "store":         {
                    "id":        {{ payment.gateway.store.id }},
                    "name":     "{{ payment.gateway.store.name }}"
                },
                "order":         {
                    "id":       "{{ payment.order.id }}"
                },
                "gateway":       {
                    "id":       "{{ payment.gateway.id }}",
                    "name":     "{{ payment.gateway.name }}"
                },
                "amount":       "{{ payment.amount|currency(payment.currency.id, app.request.locale) }}",
                "status":        {
                    "status":    {{ payment.status }},
                    "class":    "{{ ('payment.status.class.' ~ status.name(payment))|trans }}",
                    "label":    "{{ ('payment.status.label.' ~ status.name(payment))|trans }}"
                },
                "actions":      "{% include 'DzangocartCoreBundle:Payment:actions.html.twig' %}",
                "urls": {
                    "order":    "{{ param['customer'] is defined ? path('user_order', { id: payment.order.id }) : path('order', { id: payment.order.id }) }}",
                    "store":    "{% if store is not defined %}{{ path('store', { id: payment.gateway.store.id }) }}{% endif %}",
                    "gateway":  "{{ path('gateway', { id: payment.gateway.id }) }}"
                }
            }{% if not loop.last %},{% endif %}
        {% endfor %}
    ]
}
{% endspaceless %}
